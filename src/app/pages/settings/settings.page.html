<ion-header [translucent]="true" no-border>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="navCtrl.back()">
        <ion-icon slot="icon-only" name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>ðŸ›  Settings</ion-title>
  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true" class="ion-padding">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">ðŸ›  Settings</ion-title>
      <ion-title></ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-chip *ngIf="errorMessage" class="error-message" color="danger">
    {{errorMessage}}
  </ion-chip>

  <br>
  <br>

  <div *ngIf="isLoading" class="ion-text-center">
    <div style="height: 100px"></div>
    <ion-spinner></ion-spinner>
    <div style="height: 100px"></div>
  </div>

  <div *ngIf="!isLoading" class="ion-text-left web-container">
    <br>

    <div class="item-box">
      <app-image-upload [photo]="this.images.avatarURL" (onDone)="imageSelected($event, 'avatar')" customID="tile-image"></app-image-upload>
      <div class="ion-text-center opacity-half">Avatar</div>

      <form [formGroup]="form">
        <ion-grid>
          <ion-row>
            <ion-col class="ion-no-padding">
              <ion-item>
                <ion-label position="floating">First Name</ion-label>
                <ion-input 
                  #firstName 
                  formControlName="firstName" 
                  type="text"
                  [class.invalid]="!form.controls.firstName.valid" 
                  (keypress)="eventHandler($event.keyCode)">
                </ion-input>
              </ion-item>
            </ion-col>
            <ion-col class="ion-no-padding">
              <ion-item>
                <ion-label position="floating">Last Name</ion-label>
                <ion-input 
                  #lastName 
                  formControlName="lastName" 
                  type="text"
                  [class.invalid]="!form.controls.lastName.valid" 
                  (keypress)="eventHandler($event.keyCode)">
                </ion-input>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-grid>
      </form>

      <div class="spacer" style="height:12px;"></div>
    
      <!-- <ion-label padding color="danger" style="text-align:center;">{{errorMessage}}</ion-label> -->
      
      <div class="btn-wrapper">
        <ion-button (click)="submit()" color="seethrough" class="color-primary">
          Save
        </ion-button>
      </div>

    </div>

    <br>
    <br>

    <div class="item-box">
      <br>

      <ion-item lines="none">
        <ion-label position="stacked"><b>Penna Subdomain:</b>&nbsp;<ion-chip>{{ subdomain }}.penna.io</ion-chip></ion-label>
      </ion-item>

      <!-- <br>

      <ion-item>
        <ion-label position="fixed">Subdomain</ion-label>
        <ion-input [(ngModel)]="subdomain" class="ion-text-right"></ion-input>
        <ion-note slot="end" style="padding-right: 30%;">
          .penna.io
        </ion-note>
      </ion-item>

      <br>

      <div class="btn-wrapper">
        <ion-button (click)="updateSubdomain()" color="seethrough" class="color-primary">
          Save
        </ion-button>
      </div> -->
    </div>

    <br>
    <br>

    <div class="item-box">

      <br>
      <div *ngIf="!hasCustomDomain">
        <br>

        <div *ngIf="customdomain == null" class="ion-text-center"> Add your own domain below</div>
        <ion-item>
          <ion-label position="stacked">Custom Domain</ion-label>
          <ion-input [(ngModel)]="customdomain" placeholder="example.com">
          </ion-input>
        </ion-item>

        <br>

        <div class="btn-wrapper">
          <ion-button (click)="updateCustomDomain()" color="seethrough" class="color-primary">
            Save
          </ion-button>
        </div>
      </div>
      
      <div *ngIf="hasCustomDomain">
        <ion-item lines="none">
          <ion-label position="stacked"><b>Custom Domain:</b>&nbsp;<ion-chip>{{ customdomain }}</ion-chip></ion-label>
          <ion-spinner *ngIf="isDomainLoading">
          </ion-spinner>
          <div *ngIf="!isDomainLoading">
            <div *ngIf="!isDomainVerified">
              <ion-icon name="close-circle-outline" color="danger"></ion-icon>
              <span class="accent-text">The domain <span class="monospace">{{ customdomain }}</span> is not yet linked.</span>
              <br>
              <br>

              <span class="monospace"><b>Method 1</b>: "<b>A</b>" DNS Record</span>&nbsp;<span class="accent-text">(<span class="color-primary">Recommended</span>)</span>
              <div class="accent-text">
                Set the following record on your DNS provider to continue:
                <ion-grid>
                  <ion-row>
                    <ion-col>
                      <b>Type</b>
                      <br>
                      <span class="monospace">A</span>
                    </ion-col>
                    <ion-col>
                      <b>Name</b>
                      <br>
                      @
                    </ion-col>
                    <ion-col>
                      <b>Value</b>
                      <br>
                      <span class="monospace">76.76.21.21</span>
                    </ion-col>
                  </ion-row>
                </ion-grid>
              </div>

              
                <br>
                <hr style="border-top: solid lightgrey 1px;">
                <br>

              <span class="monospace"><b>Method 2</b>: "<b>NS</b>" Nameservers</span>
              <div class="accent-text">
                Please change your nameservers on your domain registrar's website:
                <ion-grid>
                  <ion-row>
                    <ion-col size="6">
                      <ion-icon name="checkmark-circle-outline" color="primary"></ion-icon>&nbsp;<span class="monospace color-primary">Penna Nameservers</span>
                      <div *ngFor="let ns of domainVerifyData.nsVerification.intendedNameservers">
                        <ion-chip color="primary">{{ ns }}</ion-chip>
                      </div>
                    </ion-col>
                    <ion-col size="6" style="border-left: solid lightgrey 1px; padding-left: 30px;">
                      <ion-icon name="close-circle-outline" color="danger"></ion-icon>&nbsp;<span class="monospace color-danger">Current Nameservers</span>
                      <div *ngFor="let ns of domainVerifyData.nsVerification.nameservers">
                        <ion-chip color="danger">{{ ns }}</ion-chip>
                      </div>
                    </ion-col>
                  </ion-row>
                </ion-grid>

                <br>
                <hr style="border-top: solid lightgrey 1px;">
                <br>
                Changes make take 1-2 days to take effect.
              </div>

            </div>

            <div class="accent-text" *ngIf="isDomainVerified">
              <ion-icon name="checkmark-circle-outline" color="primary"></ion-icon>
              linked
            </div>
          </div>
        </ion-item>
        <br>
      </div>

    </div>

    
    <br>
    <br>

  </div>
</ion-content>
